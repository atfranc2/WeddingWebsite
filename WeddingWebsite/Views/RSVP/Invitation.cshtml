@model WeddingWebsite.ViewModels.InvitationViewModel
@{
    ViewData["Title"] = "RSVP";
}

<partial name="~/Views/RSVP/PartialViews/_AttendenceForm.cshtml" model="Model" />
<partial name="~/Views/RSVP/PartialViews/_ContactInformationForm.cshtml" />
<partial name="~/Views/RSVP/PartialViews/_TimelineForm.cshtml" />
<partial name="~/Views/RSVP/PartialViews/_SongRequestForm.cshtml" />
<partial name="~/Views/RSVP/PartialViews/_DrinkForm.cshtml" model="Model" />
<partial name="~/Views/RSVP/PartialViews/_MarriageAdviceForm.cshtml" />


@section scripts {
    <script src="~/lib/bootstrap-select/js/bootstrap-select.min.js"></script>
    <link href="~/lib/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" />

    <script>
        let guestId = @Model.RSVP.GuestOneId;

        const rsvpViewModel = {
            "guestOneId": @Model.RSVP.GuestOneId,
            "guestOneName": "@Model.RSVP.GuestOneName",
            "guestTwoId": @Model.RSVP.GuestTwoId,
            "guestTwoName": "@Model.RSVP.GuestTwoName",
            "guestTag": "@Model.RSVP.GuestTag",
            "contactEmail": "",
            "guestOneAccepts": "",
            "guestTwoAccepts": "",
            "dayOfArrival": "",
            "timeOfArrival": "",
            "marriageAdvice": "",
            "songRequests": [],
            "drinkRequests": []
        };
        
    </script>

    <script src="~/ViewScripts/RSVP/Invitation/BuildViewModels.js"></script>
    <script src="~/ViewScripts/RSVP/Invitation/InitializeGlobalVariables.js"></script>
    <script src="~/ViewScripts/RSVP/Invitation/SongRequestForm.js"></script>
    <script src="~/ViewScripts/RSVP/Invitation/ButtonFunctions.js"></script>
    <script src="~/ViewScripts/RSVP/Invitation/DocumnetReady.js"></script>

    <script>

        $("#marriageAdviceForm").submit(function (e) {
            e.preventDefault();
            rsvpViewModel.marriageAdvice = $("#marriageAdvice").val(); 
            console.log(JSON.stringify(rsvpViewModel));

            $.ajax({
                url: "/api/RSVPs",
                method: "POST",
                contentType: 'application/json',
                data: JSON.stringify(rsvpViewModel)
            });
        });


    </script>

}
